generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")

}

enum UserRole {
  ADMIN
  MANAGER
  USER
}

enum UserStatus {
  ACTIVE
  INACTIVE
}

model User {
  id            String      @id @default(cuid())
  name          String
  email         String      @unique
  password      String
  phone         String?
  role          UserRole    @default(USER)
  status        UserStatus  @default(ACTIVE)
  avatar        String?     @default("https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80")
  joinDate      DateTime    @default(now())
  lastActive    DateTime?   @updatedAt
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  // Car listing permissions (simple boolean fields)
  canManageListings Boolean @default(false)
  canApproveListings Boolean @default(false)
  canManageWebsite  Boolean @default(false)

  @@map("users")
}

model CarListing {
  id           String   @id @default(cuid())
  reference    String   @unique
  carName      String
  year         Int
  price        Float
  location     String
  carType      String
  mileage      Int
  transmission String
  fuelType     String
  features     Json     // Keep as Json for MySQL
  description  String
  sellerName   String
  sellerPhone  String
  sellerEmail  String
  file         String? 
  files        Json     // Keep as Json for MySQL
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("car_listings")
}


model Car {
  id               String   @id @default(cuid())
  reference        String   @unique
  carName          String
  year             Int
  price            Float
  location         String
  carType          String
  mileage          Int
  transmission     String
  fuelType         String
  engineSize       String?
  color            String?
  doors            Int?
  seats            Int?
  features         Json
  description      String
  carCondition     String?   @default("excellent")
  serviceHistory   String?   @default("full")
  accidentHistory  String?   @default("none")
  ownershipHistory String?
  roadTaxStatus    String?   @default("current")
  insuranceStatus  String?   @default("comprehensive")
  sellerName       String
  sellerPhone      String
  sellerEmail      String
  preferredContact String?   @default("phone")
  priceNegotiable  Boolean?  @default(true)
  testDrive        Boolean?  @default(true)
  warranty         Boolean?  @default(false)
  warrantyMonths   Int?
  serviceRecords   Boolean?  @default(true)
  originalPaint    Boolean?  @default(true)
  modifications    String?   @default("none")
  file             String?
  files            Json

 status           String?   @default("pending")
  adminNotes       String?   @default("")
  rejectionReason  String?   @default("")
  reviewedAt       DateTime?
  reviewedBy       String?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@map("car")
}





model Subscriber {
  id        String   @id @default(cuid())
  email     String   @unique
  createdAt DateTime @default(now())

  @@map("subscribers")
}



enum PostStatus {
  DRAFT      // Private, only visible to editors
  PUBLISHED  // Publicly visible
  ARCHIVED   // Public but usually hidden from main lists
}

model BlogPost {
  // Core Fields
  id              String      @id @default(cuid())
  slug            String      @unique      // Crucial for SEO-friendly URLs (e.g., /blog/my-post-slug)
  title           String      @db.VarChar(255)
  excerpt         String      @db.VarChar(500)
  content         String      @db.Text
  
  // Author & Relations
  // ⚠️ FIX: Removed authorId and author relation
  authorName      String      @default("Admin") // Retained for display purposes

  // Media (Files and Images)
  mainImage       String?     // URL for the featured image (Crucial for social sharing/SEO)
  imageAltText    String?     // Alt text for accessibility and image SEO

  // Publishing & Status
  status          PostStatus  @default(DRAFT)
  featured        Boolean     @default(false)
  tags            String      
  category        String?

  // SEO Fields
  metaTitle       String?     @db.VarChar(100)
  metaDescription String?     @db.VarChar(200)

  // Engagement Metrics
  views           Int         @default(0)
  likes           Int         @default(0)
  commentsCount   Int         @default(0)
  readTime        String?

  // Timestamps
  publishDate     DateTime?   // Manually set publication date
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  @@index([status, publishDate])

  @@map("blog_posts")
}
