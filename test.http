### Test API URL Variable
@baseUrl = http://localhost:3001/api/sellyourcar
# NOTE: Replace this ID with the ID returned from the POST request (Request 2)
@carId = cmibyxawi0002kk54bdbra1u4

# --- 1. GET ALL LISTINGS ---
# Endpoint: GET /api/sellyourcar
# Used to verify the list and find an ID for subsequent tests.
GET {{baseUrl}}

###

# --- 2. CREATE NEW CAR LISTING (POST) ---
# Endpoint: POST /api/sellyourcar
# CRITICAL FIX: The field for image upload is correctly named "files"
POST {{baseUrl}}
Content-Type: multipart/form-data; boundary=WebAppBoundary

--WebAppBoundary
Content-Disposition: form-data; name="carName"

Volkswagen Golf GTI
--WebAppBoundary
Content-Disposition: form-data; name="price"

3800000
--WebAppBoundary
Content-Disposition: form-data; name="location"

Nairobi, Westlands
--WebAppBoundary
Content-Disposition: form-data; name="year"

2019
--WebAppBoundary
Content-Disposition: form-data; name="carType"

Hatchback
--WebAppBoundary
Content-Disposition: form-data; name="mileage"

45000
--WebAppBoundary
Content-Disposition: form-data; name="transmission"

Automatic
--WebAppBoundary
Content-Disposition: form-data; name="fuelType"

Petrol
--WebAppBoundary
Content-Disposition: form-data; name="description"

Immaculate 2019 GTI. Low mileage, performance pack installed.
--WebAppBoundary
Content-Disposition: form-data; name="sellerName"

Jane Doe
--WebAppBoundary
Content-Disposition: form-data; name="sellerPhone"

+254711998877
--WebAppBoundary
Content-Disposition: form-data; name="sellerEmail"

jane.doe@gti.co.ke
--WebAppBoundary
Content-Disposition: form-data; name="features"

Heated Seats
--WebAppBoundary
Content-Disposition: form-data; name="features"

Digital Cockpit
--WebAppBoundary
# **CRITICAL FIX**: Using 'files' to match your Car model schema
Content-Disposition: form-data; name="files"; filename="gti_front.jpg"

< ./images/gti_front.jpg
--WebAppBoundary
Content-Disposition: form-data; name="files"; filename="gti_interior.png"

< ./images/gti_interior.png
--WebAppBoundary--

###

# --- 3. GET SINGLE LISTING ---
# Endpoint: GET /api/sellyourcar/:id
# Check the car created in step 2.
GET {{baseUrl}}/{{carId}}

###

# --- 4. UPDATE EXISTING CAR LISTING (PUT) ---
# Endpoint: PUT /api/sellyourcar/:id
# NOTE: Replace {{carId}} with a valid ID before running this request.
# The PUT logic handles optional fields.
PUT {{baseUrl}}/{{carId}}
Content-Type: multipart/form-data; boundary=WebAppBoundary

--WebAppBoundary
Content-Disposition: form-data; name="price"

3750000 
--WebAppBoundary
Content-Disposition: form-data; name="description"

Price lowered! Must sell this week.
--WebAppBoundary
Content-Disposition: form-data; name="features"

Heated Seats
--WebAppBoundary
Content-Disposition: form-data; name="features"

Sunroof (New)
--WebAppBoundary
# Existing Image: (If applicable) The actual path returned from the POST request
Content-Disposition: form-data; name="existingImagesToKeep"

/uploads/123456789-gti_front.jpg
--WebAppBoundary
# Add a new image
Content-Disposition: form-data; name="files"; filename="gti_engine.webp"

< ./images/gti_engine.webp
--WebAppBoundary--

###

# --- 5. DELETE LISTING ---
# Endpoint: DELETE /api/sellyourcar/:id
# NOTE: Run this last to clean up the test entry.
DELETE {{baseUrl}}/{{carId}}